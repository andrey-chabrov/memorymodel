{% extends "base.html" %}

{% load url from future %}


{% block javascript %} 
    <script src="{{ MEDIA_URL }}js/lodash-2.4.1.min.js" type="text/javascript"></script>
    <script id="formset-templ" type="text/template">{% include "formset_js_templ.html" %}</script>
{% endblock %}

{% block content %}

	<ul>
        {% for model_name, name, model in models %}
        	<li><a href='{% url "model" modelname=model_name %}'>{{ name }}</a></li>
        {% endfor %}
	</ul>

    <form method='POST' action=''>{% csrf_token %}

        <table border=1>

            {{ formset.management_form }}

            <tr>
                {% for field in formset.0.visible_fields %}
                    <td>{{ field.label }}</td>
                {% endfor %}
            </tr>

            {% for form in formset %}
                {% if forloop.last %}
                    <tr>
                        <td>Новый {{ verbose_name }}</td>
                    </tr>
                {% endif %}
                <tr>
                    {% for field in form.visible_fields %}
                        <td>{% include "field.html" %}</td>
                    {% endfor %}
                </tr>
            {% endfor %}

        </table>

        {% for form in formset %}
            {% for field in form.hidden_fields %}
                {{ field }}
            {% endfor %}
        {% endfor %}

        {% if formset != None %}
            <input class="save-button" type="submit" value="Отправить" />
        {% endif %}

    </form>

{% endblock %}
